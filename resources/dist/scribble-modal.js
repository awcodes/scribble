window.scribbleModal=()=>({show:!1,showActiveComponent:!0,activeComponent:!1,componentHistory:[],modalWidth:null,modalAlignment:null,isSlideOver:!1,slideDirection:"right",listeners:[],getActiveComponentModalAttribute(e){if(this.$wire.get("components")[this.activeComponent]!==void 0)return this.$wire.get("components")[this.activeComponent].modalAttributes[e]},closeModalOnEscape(){if(this.getActiveComponentModalAttribute("closeOnEscape")===!1)return;let e=this.getActiveComponentModalAttribute("closeOnEscapeIsForceful")===!0;this.closeScribbleModal(e)},closeModalOnClickAway(){this.getActiveComponentModalAttribute("closeOnClickAway")!==!1&&this.closeScribbleModal(!0)},closeScribbleModal(e=!1,t=0,o=!1){if(this.show===!1)return;if(this.getActiveComponentModalAttribute("dispatchCloseEvent")===!0){let s=this.$wire.get("components")[this.activeComponent].name;Livewire.dispatch("scribbleModalClosed",{name:s})}if(this.getActiveComponentModalAttribute("destroyOnClose")===!0&&Livewire.dispatch("destroyScribbleComponent",{id:this.activeComponent}),t>0)for(let s=0;s<t;s++){if(o){let n=this.componentHistory[this.componentHistory.length-1];Livewire.dispatch("destroyScribbleComponent",{id:n})}this.componentHistory.pop()}let i=this.componentHistory.pop();i&&!e?i?this.setActiveModalComponent(i,!0):this.setShowPropertyTo(!1):this.setShowPropertyTo(!1)},setActiveModalComponent(e,t=!1){if(this.setShowPropertyTo(!0),this.activeComponent===e)return;this.activeComponent!==!1&&t===!1&&this.componentHistory.push(this.activeComponent);let o=50;this.activeComponent===!1?(this.activeComponent=e,this.showActiveComponent=!0,this.initializeComponent()):(this.showActiveComponent=!1,o=400,setTimeout(()=>{this.activeComponent=e,this.showActiveComponent=!0,this.initializeComponent()},300)),this.$nextTick(()=>{let i=this.$refs[e]?.querySelector("[autofocus]");i&&setTimeout(()=>{i.focus()},o)})},initializeComponent(){this.modalWidth=this.getActiveComponentModalAttribute("maxWidth"),this.modalAlignment=this.getActiveComponentModalAttribute("alignment"),this.isSlideOver=this.getActiveComponentModalAttribute("isSlideOver"),this.slideDirection=this.getActiveComponentModalAttribute("slideDirection")},focusables(){return[...this.$el.querySelectorAll("a, button, input:not([type='hidden'], textarea, select, details, [tabindex]:not([tabindex='-1'])")].filter(t=>!t.hasAttribute("disabled"))},firstFocusable(){return this.focusables()[0]},lastFocusable(){return this.focusables().slice(-1)[0]},nextFocusable(){return this.focusables()[this.nextFocusableIndex()]||this.firstFocusable()},prevFocusable(){return this.focusables()[this.prevFocusableIndex()]||this.lastFocusable()},nextFocusableIndex(){return(this.focusables().indexOf(document.activeElement)+1)%(this.focusables().length+1)},prevFocusableIndex(){return Math.max(0,this.focusables().indexOf(document.activeElement))-1},setShowPropertyTo(e){this.show=e,e?document.body.classList.add("overflow-y-hidden"):(document.body.classList.remove("overflow-y-hidden"),setTimeout(()=>{this.activeComponent=!1,this.$wire.resetState()},300))},init(){this.initializeComponent(),this.listeners.push(Livewire.on("closeScribbleModal",e=>{this.closeScribbleModal(e?.force??!1,e?.skipPreviousModals??0,e?.destroySkipped??!1)})),this.listeners.push(Livewire.on("activeScribbleModalComponentChanged",({id:e})=>{this.setActiveModalComponent(e)}))},destroy(){this.listeners.forEach(e=>{e()})}});
